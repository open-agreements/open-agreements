## ADDED Requirements

### Requirement: JSON Contract Specifications for Generated Templates
The system SHALL support JSON contract specification files that separate
contract content from rendering logic. Each JSON spec SHALL declare a layout id,
a style id, and structured content blocks required by that layout.

#### Scenario: JSON spec drives generation without content-in-code duplication
- **WHEN** maintainers define two contracts with different clause text but the same layout id
- **THEN** both contracts are generated by the same shared renderer layout module
- **AND** contract-specific text is sourced from JSON specs rather than duplicated JS renderer code

#### Scenario: Invalid JSON spec fails before DOCX generation
- **WHEN** a contract JSON spec is missing required layout/style/content fields
- **THEN** validation fails before render
- **AND** the error identifies the spec file and invalid field path

### Requirement: Shared Template Renderer with Layout Registry
The system SHALL provide a shared template renderer that composes layout modules,
style profiles, and content specs. Layout modules SHALL be reusable across
multiple contracts.

#### Scenario: Multiple templates share one renderer layout
- **WHEN** several templates reference the same layout id
- **THEN** the generation pipeline uses one layout implementation for all of them
- **AND** maintainers can add a new template instance by adding a JSON spec without creating a new renderer

#### Scenario: Unknown layout id is rejected
- **WHEN** a spec references a layout id that is not registered
- **THEN** generation fails with an actionable error listing the unknown layout id

### Requirement: Style Tokenized Formatting Invariants
Formatting rules for generated templates SHALL be defined through style tokens
and enforced by regression tests. Style-tokenized spacing values SHALL be applied
consistently by layout modules.

#### Scenario: Standard Terms 6pt spacing is enforced by style tokens
- **WHEN** a template using the shared contract layout is generated
- **THEN** Standard Terms body and heading paragraphs use 6pt after-spacing where required by the style profile
- **AND** regression tests fail if a renderer change causes spacing drift

#### Scenario: Style profile validation catches malformed spacing values
- **WHEN** a style profile contains invalid token values (for example non-numeric paragraph spacing)
- **THEN** style profile validation fails before generation
- **AND** the error points to the malformed token path

### Requirement: Backward-Compatible Fill Placeholder Semantics
Migration to JSON specs and shared renderer layouts SHALL preserve existing fill
placeholder semantics for generated templates.

#### Scenario: Existing placeholder names remain stable after migration
- **WHEN** an employment template is migrated from content-in-JS to JSON spec content
- **THEN** generated DOCX placeholders keep the same `{field_name}` tags expected by metadata and fill flow
- **AND** `open-agreements fill` continues to work without metadata schema changes
